<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script type="text/javascript" src="/gun.js"></script>
    <title>Document</title>
  </head>
  <body>
    <div id="serverList"></div>
    <script type="text/javascript">
      let d = new Date();
      var gun = Gun({ peers: [`${window.location.hostname}/gun`] });
      setInterval(
        () =>
          gun
            .get("servers")
            .put({ [`${window.location.hostname}`]: d.toDateString() }),
        1000
      );
      gun.get("servers").on((peer) => console.log(peer));
      gun
        .get("servers")
        .on((peer) =>
          document.getElementById(
            window.location.hostname.replace(/[.]/g, "")
          ) === undefined ||
          document.getElementById(
            window.location.hostname.replace(/[.]/g, "")
          ) === null
            ? (document.getElementById(
                "serverList"
              ).innerHTML = `"<div id='${window.location.hostname.replace(
                /[.]/g,
                ""
              )}'>${peer}</div>"`)
            : (document.getElementById(
                `${window.location.hostname.replace(/[.]/g, "")}`
              ).innerText = peer)
        );
    </script>
  </body>
</html>
